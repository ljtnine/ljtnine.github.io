<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Core"><title>S扫描器源码 · Hexo</title><meta name="description" content="123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798"><meta name="keywords" content="NINE的博客,记录与分享计算机技术"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><script src="/js/jquery.js"></script><meta name="generator" content="Hexo 5.2.0"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">Hexo</a></h3><div class="description"><p>NINE的博客。<br> 记录与分享计算机技术。</p></div></div></div><ul class="social-links"><li><a target="_blank" rel="noopener" href="https://github.com/xuncv"><i class="fa fa-github"></i></a></li><li><a href="mailto:xuncv1@gmail.com"><i class="fa fa-envelope"></i></a></li><li><a target="_blank" rel="noopener" href="http://sighttp.qq.com/authd?IDKEY="><i class="fa fa-qq"></i></a></li><li><a target="_blank" rel="noopener" href="https://zhihu.com/ljtnine/"><i class="fa fa-mortar-board"></i></a></li></ul><div class="footer"><div class="p"> <span>© 2017 - 2020 </span><i class="fa fa-star"></i><span> Core</span></div><div class="by_farbox"><span>Powered by </span><a href="https://hexo.io/zh-cn/" target="_blank">Hexo </a><span> & </span><a href="https://github.com/mrcore/hexo-theme-Anatole-Core" target="_blank">Anatole-Core  </a></div><div class="beian"><a href="http://www.beian.miit.gov.cn/" target="_blank"></a><span style="height:10px;margin-left: 10px;">|</span><img src="https://qn.jixian.io/gongan.png" style="height:10px;margin-left: 10px;position: relative;top: 1px;"><span style="margin-left: 2px;"></span></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/archives">归档</a></li><li><a href="/tags">标签</a></li><li><a href="/about">关于</a></li><li><a href="/guestbook">留言</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>S扫描器源码</a></h3></div><div class="post-content"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(linker, <span class="meta-string">&quot;/subsystem:console /FILEALIGN:0x200 /opt:nowin98 /IGNORE:4078 /MERGE:.rdata=.text /MERGE:.data=.text /section:.text,ERW&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _WIN32_WINNT	0x0403</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;winsock2.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Iphlpapi.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib, <span class="meta-string">&quot;ws2_32.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib, <span class="meta-string">&quot;Iphlpapi.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> pack(push, 1)<span class="comment">//取消内存大小自动对齐</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">iphdr</span>    </span></span><br><span class="line"><span class="class">&#123;</span>   </span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> h_lenver; <span class="comment">//4位首部长度+4位IP版本号    </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> tos; <span class="comment">//8位服务类型TOS    </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">short</span> total_len; <span class="comment">//16位总长度（字节）    </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">short</span> ident; <span class="comment">//16位标识    </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">short</span> frag_and_flags; <span class="comment">//3位标志位    </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> ttl; <span class="comment">//8位生存时间 TTL    </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> proto; <span class="comment">//8位协议 (TCP, UDP 或其他)    </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">short</span> checksum; <span class="comment">//16位IP首部校验和    </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> sourceIP; <span class="comment">//32位源IP地址    </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> destIP; <span class="comment">//32位目的IP地址    </span></span><br><span class="line">&#125;IP_HEADER;   </span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">tcphdr</span> //定义<span class="title">TCP</span>首部    </span></span><br><span class="line"><span class="class">&#123;</span>   </span><br><span class="line">	USHORT th_sport; <span class="comment">//16位源端口    </span></span><br><span class="line">	USHORT th_dport; <span class="comment">//16位目的端口    </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> th_seq; <span class="comment">//32位序列号    </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> th_ack; <span class="comment">//32位确认号    </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> th_lenres; <span class="comment">//4位首部长度/6位保留字    </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> th_flag; <span class="comment">//6位标志位    </span></span><br><span class="line">	USHORT th_win; <span class="comment">//16位窗口大小    </span></span><br><span class="line">	USHORT th_sum; <span class="comment">//16位校验和    </span></span><br><span class="line">	USHORT th_urp; <span class="comment">//16位紧急数据偏移量    </span></span><br><span class="line">&#125;TCP_HEADER;    </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> //定义<span class="title">TCP</span>伪首部    </span></span><br><span class="line"><span class="class">&#123;</span>   </span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">long</span> saddr; <span class="comment">//源地址    </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">long</span> daddr; <span class="comment">//目的地址    </span></span><br><span class="line">	<span class="keyword">char</span> mbz;   </span><br><span class="line">	<span class="keyword">char</span> ptcl; <span class="comment">//协议类型    </span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">short</span> tcpl; <span class="comment">//TCP长度    </span></span><br><span class="line">&#125;psd_header;   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> pack(pop)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CRITICAL_SECTION	_cs;</span><br><span class="line"></span><br><span class="line">BOOL	_isLog = FALSE;</span><br><span class="line">BOOL	_isBanner = FALSE;</span><br><span class="line">BOOL	_isRangeScan;</span><br><span class="line">BOOL	_isSinglePort;</span><br><span class="line">BOOL	_isBreak;</span><br><span class="line">BOOL	_isMultiplePort;</span><br><span class="line"></span><br><span class="line">DWORD	_startIp;</span><br><span class="line">DWORD	_endIp;</span><br><span class="line">DWORD	_portToScan;</span><br><span class="line">DWORD	_portScanSingle;</span><br><span class="line">DWORD	dword_407090;</span><br><span class="line">DWORD	_portsTotal;</span><br><span class="line">DWORD	_threadsUsed;</span><br><span class="line">DWORD	_totalPortsOpen;</span><br><span class="line">DWORD	_ipScanned;</span><br><span class="line">DWORD	_tcpTimeout = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">u_long	_bindIpAddr;</span><br><span class="line">SOCKET	_s; <span class="comment">// idb</span></span><br><span class="line">LPCSTR	_logFile = <span class="string">&quot;Result.txt&quot;</span>; <span class="comment">// idb</span></span><br><span class="line"><span class="keyword">char</span>	_httpRequest[] = <span class="string">&quot;HEAD / HTTP/1.0\r\n\r\n&quot;</span>;</span><br><span class="line"><span class="keyword">void</span> *	_portsArray;</span><br><span class="line"></span><br><span class="line">LONG	_maxThreads;</span><br><span class="line">HANDLE	_semaphore;</span><br><span class="line">BOOL	_isHttp = FALSE;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getrandom</span><span class="params">(<span class="keyword">int</span> begin, <span class="keyword">int</span> end)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	LARGE_INTEGER tick; </span><br><span class="line">	QueryPerformanceCounter(&amp;tick);</span><br><span class="line">	<span class="keyword">return</span> (begin + tick.LowPart % (end - begin + <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">help</span><span class="params">(<span class="keyword">char</span> * app)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Usage:   %s TCP/SYN StartIP [EndIP] Ports [Threads] [/T(N)] [/(H)Banner] [/Save]\n&quot;</span>, app);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Example: %s TCP 12.12.12.12 12.12.12.254 80 512\n&quot;</span>, app);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Example: %s TCP 12.12.12.12/24 80 512\n&quot;</span>, app);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Example: %s TCP 12.12.12.12/24 80 512 /T8 /Save\n&quot;</span>, app);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Example: %s TCP 12.12.12.12 12.12.12.254 80 512 /HBanner\n&quot;</span>, app);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Example: %s TCP 12.12.12.12 12.12.12.254 21 512 /Banner\n&quot;</span>, app);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Example: %s TCP 12.12.12.12 1-65535 512\n&quot;</span>, app);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Example: %s TCP 12.12.12.12 12.12.12.254 21,3389,5631 512\n&quot;</span>, app);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Example: %s TCP 12.12.12.12 21,3389,5631 512\n&quot;</span>, app);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Example: %s SYN 12.12.12.12 12.12.12.254 80\n&quot;</span>, app);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Example: %s SYN 12.12.12.12 1-65535\n&quot;</span>, app);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Example: %s SYN 12.12.12.12 12.12.12.254 21,80,3389\n&quot;</span>, app);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">&quot;Example: %s SYN 12.12.12.12 21,80,3389\n&quot;</span>, app);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">BOOL WINAPI <span class="title">ConsoleCtrlHandler</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  DWORD dwCtrlType   <span class="comment">//  control signal type</span></span></span></span><br><span class="line"><span class="function"><span class="params">  )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">switch</span> (dwCtrlType) </span><br><span class="line">	&#123; </span><br><span class="line">		<span class="comment">/* Handle the CTRL-C signal. */</span></span><br><span class="line">    <span class="keyword">case</span> CTRL_C_EVENT: </span><br><span class="line">    <span class="keyword">case</span> CTRL_CLOSE_EVENT: </span><br><span class="line">    <span class="keyword">case</span> CTRL_BREAK_EVENT:  </span><br><span class="line">    <span class="keyword">case</span> CTRL_LOGOFF_EVENT: </span><br><span class="line">    <span class="keyword">case</span> CTRL_SHUTDOWN_EVENT:</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;CTRL+C Is Pressed                          \n&quot;</span>);</span><br><span class="line">		_isBreak = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">return</span> TRUE;		</span><br><span class="line">    <span class="keyword">default</span>: </span><br><span class="line">		<span class="keyword">return</span> FALSE;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isWin2K</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">bool</span> result; <span class="comment">// eax@8</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> _<span class="title">OSVERSIONINFOA</span> <span class="title">VersionInformation</span>;</span> <span class="comment">// [sp+0h] [bp-94h]@2</span></span><br><span class="line">	</span><br><span class="line">	VersionInformation.dwOSVersionInfoSize = <span class="number">148</span>;</span><br><span class="line">	<span class="keyword">if</span> ( GetVersionExA(&amp;VersionInformation) )</span><br><span class="line">	&#123;</span><br><span class="line">		result = VersionInformation.dwPlatformId == <span class="number">2</span> &amp;&amp; VersionInformation.dwMajorVersion == <span class="number">5</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		result = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//----- (00403704) --------------------------------------------------------</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">initWinsock</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	WSAData wsaData;</span><br><span class="line">	<span class="keyword">return</span> (WSAStartup(<span class="number">0x202</span>u, &amp;wsaData) == <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//----- (004040C0) --------------------------------------------------------</span></span><br><span class="line"><span class="function">BOOL __cdecl <span class="title">logWriteBuffer</span><span class="params">(LPCSTR lpFileName, <span class="keyword">char</span> *lpBuffer)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	BOOL result; <span class="comment">// eax@4</span></span><br><span class="line">	HANDLE v4; <span class="comment">// eax@3</span></span><br><span class="line">	DWORD v5; <span class="comment">// eax@5</span></span><br><span class="line">	DWORD NumberOfBytesWritten; <span class="comment">// [sp+0h] [bp-Ch]@2</span></span><br><span class="line">	HANDLE hObject; <span class="comment">// [sp+8h] [bp-4h]@3</span></span><br><span class="line">	BOOL v8; <span class="comment">// [sp+4h] [bp-8h]@5</span></span><br><span class="line"></span><br><span class="line">	hObject = <span class="number">0</span>;</span><br><span class="line">	v4 = CreateFileA(lpFileName, <span class="number">0xC0000000</span>u, <span class="number">2u</span>, <span class="number">0</span>, <span class="number">4u</span>, <span class="number">0x80</span>u, <span class="number">0</span>);</span><br><span class="line">	hObject = v4;</span><br><span class="line">	<span class="keyword">if</span> ( v4 == (HANDLE)<span class="number">-1</span> )</span><br><span class="line">	&#123;</span><br><span class="line">		result = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		SetFilePointer(hObject, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2u</span>);</span><br><span class="line">		v5 = lstrlen(lpBuffer);</span><br><span class="line">		v8 = WriteFile(hObject, lpBuffer, v5, &amp;NumberOfBytesWritten, <span class="number">0</span>);</span><br><span class="line">		CloseHandle(hObject);</span><br><span class="line">		result = v8;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//----- (00404147) --------------------------------------------------------</span></span><br><span class="line"><span class="function">BOOL __cdecl <span class="title">logWriteTime</span><span class="params">(LPCSTR lpFileName)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	DWORD Buffer[<span class="number">64</span>]; <span class="comment">// [sp+0h] [bp-110h]@2</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> _<span class="title">SYSTEMTIME</span> <span class="title">SystemTime</span>;</span> <span class="comment">// [sp+100h] [bp-10h]@3</span></span><br><span class="line">	</span><br><span class="line">	GetLocalTime(&amp;SystemTime);</span><br><span class="line">	wsprintf(</span><br><span class="line">		(<span class="keyword">char</span> *)Buffer,</span><br><span class="line">		<span class="string">&quot;Performing Time: %d/%d/%d %d:%d:%d --&gt; &quot;</span>,</span><br><span class="line">		SystemTime.wMonth,</span><br><span class="line">		SystemTime.wDay,</span><br><span class="line">		SystemTime.wYear,</span><br><span class="line">		SystemTime.wHour,</span><br><span class="line">		SystemTime.wMinute,</span><br><span class="line">		SystemTime.wSecond);</span><br><span class="line">	<span class="keyword">return</span> logWriteBuffer(lpFileName, (<span class="keyword">char</span> *)Buffer);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//----- (004041D8) --------------------------------------------------------</span></span><br><span class="line"><span class="function">BOOL <span class="title">myRecv</span><span class="params">(SOCKET s, <span class="keyword">char</span> *buf, <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ret; <span class="comment">// eax@10</span></span><br><span class="line">	BOOL result; <span class="comment">// eax@12</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">timeval</span> <span class="title">timeout</span>;</span> <span class="comment">// [sp+4h] [bp-110h]@3</span></span><br><span class="line">	fd_set readfds; <span class="comment">// [sp+10h] [bp-104h]@3</span></span><br><span class="line"></span><br><span class="line">	result = FALSE;</span><br><span class="line">	timeout.tv_sec = <span class="number">3</span>;</span><br><span class="line">	timeout.tv_usec = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (_isHttp)</span><br><span class="line">	&#123;</span><br><span class="line">		ret = send(s, _httpRequest, <span class="keyword">sizeof</span>(_httpRequest), <span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	FD_ZERO(&amp;readfds);</span><br><span class="line">	FD_SET(s, &amp;readfds);</span><br><span class="line">	ret = select(<span class="number">0</span>, &amp;readfds, <span class="number">0</span>, <span class="number">0</span>, &amp;timeout);</span><br><span class="line">	<span class="keyword">if</span> ( ret &amp;&amp; ret != <span class="number">-1</span> )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ( FD_ISSET(s, &amp;readfds) )</span><br><span class="line">		&#123;</span><br><span class="line">			result = recv(s, buf, len, <span class="number">0</span>) &gt; <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">const</span> <span class="keyword">char</span> * <span class="title">getBanner</span><span class="params">(<span class="keyword">char</span> *response)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">signed</span> <span class="keyword">int</span> result; <span class="comment">// eax@4</span></span><br><span class="line">	<span class="keyword">signed</span> <span class="keyword">int</span> v4; <span class="comment">// edi@6</span></span><br><span class="line">	<span class="keyword">signed</span> <span class="keyword">int</span> v5; <span class="comment">// edi@9</span></span><br><span class="line">	<span class="keyword">size_t</span> v7; <span class="comment">// [sp+0h] [bp-4h]@1</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ( response )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span>	len = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span> (_isHttp)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">const</span> <span class="keyword">char</span> * tag = <span class="string">&quot;Server: &quot;</span>;</span><br><span class="line">			<span class="keyword">char</span> * serverBanner = <span class="built_in">strstr</span>(response, tag);</span><br><span class="line">			<span class="keyword">if</span> (!serverBanner)</span><br><span class="line">			&#123;</span><br><span class="line">				serverBanner = response;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				serverBanner += lstrlen(tag);</span><br><span class="line">			&#125;			</span><br><span class="line">			len = lstrlen(serverBanner);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (serverBanner[i] == <span class="string">&#x27;\r&#x27;</span> || serverBanner[i] == <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					serverBanner[i] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> serverBanner;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			len = lstrlen(response);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; lstrlen(response); i++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (response[i] == <span class="string">&#x27;\r&#x27;</span> || response[i] == <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					response[i] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		result = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		result = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">  <span class="keyword">return</span> response;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//----- (004037A8) --------------------------------------------------------</span></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">tcpScanThread</span><span class="params">(LPVOID lparam)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> ret; <span class="comment">// eax@5</span></span><br><span class="line">  <span class="keyword">char</span> banner[<span class="number">0x400</span>]; <span class="comment">// [sp+0h] [bp-330h]@2</span></span><br><span class="line">  u_long hostlong; <span class="comment">// [sp+208h] [bp-128h]@3</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [sp+200h] [bp-130h]@3</span></span><br><span class="line">  <span class="keyword">char</span> response[<span class="number">200</span>]; <span class="comment">// [sp+114h] [bp-21Ch]@3</span></span><br><span class="line">  SOCKET s; <span class="comment">// [sp+228h] [bp-108h]@3</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">timeval</span> <span class="title">timeout</span>;</span> <span class="comment">// [sp+20Ch] [bp-124h]@3</span></span><br><span class="line">  u_long argp; <span class="comment">// [sp+204h] [bp-12Ch]@3</span></span><br><span class="line">  <span class="keyword">char</span> targetHost[<span class="number">0x200</span>]; <span class="comment">// [sp+1E0h] [bp-150h]@3</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">sa</span>;</span> <span class="comment">// [sp+214h] [bp-11Ch]@4</span></span><br><span class="line">  fd_set writefds; <span class="comment">// [sp+22Ch] [bp-104h]@8</span></span><br><span class="line">  <span class="keyword">int</span> recvLen = <span class="number">0</span>;</span><br><span class="line">  hostlong = *(DWORD *)lparam;</span><br><span class="line">  v9 = *((DWORD *)lparam + <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">free</span>(lparam);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(response, <span class="number">0</span>, <span class="keyword">sizeof</span>(response));</span><br><span class="line">  s = <span class="number">-1</span>;</span><br><span class="line">  timeout.tv_sec = _tcpTimeout;</span><br><span class="line">  timeout.tv_usec = <span class="number">0</span>;</span><br><span class="line">  argp = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">memset</span>(targetHost, <span class="number">0</span>, <span class="keyword">sizeof</span>(targetHost));</span><br><span class="line">  s = socket(AF_INET, SOCK_STREAM, IPPROTO_IP);</span><br><span class="line">  <span class="keyword">if</span> ( s != <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">	<span class="built_in">memset</span>(&amp;sa, <span class="number">0</span>, <span class="keyword">sizeof</span>(sa)); </span><br><span class="line">	sa.sin_family = AF_INET; </span><br><span class="line">	sa.sin_addr.s_addr = htonl(hostlong); </span><br><span class="line">	sa.sin_port = htons(v9); </span><br><span class="line">    argp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( ioctlsocket(s, FIONBIO, &amp;argp) != <span class="number">-1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      ret = connect(s, (<span class="keyword">const</span> struct sockaddr *)&amp;sa, <span class="keyword">sizeof</span>(sa));</span><br><span class="line">      <span class="keyword">if</span> ( ret != <span class="number">-1</span> )</span><br><span class="line">	  &#123;</span><br><span class="line">        <span class="keyword">goto</span> __recv;</span><br><span class="line">	  &#125;</span><br><span class="line">      <span class="keyword">if</span> ( WSAGetLastError() == WSAEWOULDBLOCK)</span><br><span class="line">      &#123;</span><br><span class="line">		FD_ZERO(&amp;writefds);</span><br><span class="line">		FD_SET(s, &amp;writefds);</span><br><span class="line">        ret = select(<span class="number">0</span>, <span class="number">0</span>, &amp;writefds, <span class="number">0</span>, &amp;timeout);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( FD_ISSET(s, &amp;writefds) )</span><br><span class="line">        &#123;</span><br><span class="line">__recv:</span><br><span class="line">          wsprintf(</span><br><span class="line">            targetHost,</span><br><span class="line">            <span class="string">&quot;%d.%d.%d.%d&quot;</span>,</span><br><span class="line">            hostlong &gt;&gt; <span class="number">24</span>,</span><br><span class="line">            (hostlong &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>,</span><br><span class="line">            (<span class="keyword">unsigned</span> __int16)((WORD)hostlong &gt;&gt; <span class="number">8</span>),</span><br><span class="line">            (<span class="keyword">unsigned</span> __int8)hostlong);</span><br><span class="line">          EnterCriticalSection(&amp;_cs);</span><br><span class="line">          ++_totalPortsOpen;</span><br><span class="line">          LeaveCriticalSection(&amp;_cs);</span><br><span class="line">		  <span class="keyword">const</span> <span class="keyword">char</span> *	responseBanner = <span class="literal">NULL</span>;</span><br><span class="line">          <span class="keyword">if</span> ( _isBanner )</span><br><span class="line">          &#123;</span><br><span class="line">				  <span class="comment">// 切回同步模式</span></span><br><span class="line">				argp = <span class="number">0</span>;</span><br><span class="line">				ioctlsocket(s, FIONBIO, &amp;argp);</span><br><span class="line">				recvLen = myRecv(s, response, <span class="keyword">sizeof</span>(response));</span><br><span class="line">				EnterCriticalSection(&amp;_cs);</span><br><span class="line">				<span class="keyword">if</span> ( recvLen )</span><br><span class="line">				&#123;</span><br><span class="line">				  responseBanner = getBanner(response);</span><br><span class="line">				  <span class="keyword">if</span> ( lstrlen(responseBanner) &lt;= <span class="number">6</span> )</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">&quot;%-16s %-5d -&gt; \&quot;%s\&quot;           \n&quot;</span>, targetHost, v9, responseBanner);</span><br><span class="line">				  <span class="keyword">else</span></span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">&quot;%-16s %-5d -&gt; \&quot;%s\&quot;\n&quot;</span>, targetHost, v9, responseBanner);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">				&#123;</span><br><span class="line">				  <span class="built_in">printf</span>(<span class="string">&quot;%-16s %-5d -&gt; NULL             \n&quot;</span>, targetHost, v9);</span><br><span class="line">				&#125;</span><br><span class="line">				LeaveCriticalSection(&amp;_cs);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            EnterCriticalSection(&amp;_cs);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%-16s %-5d Open             \n&quot;</span>, targetHost, v9);</span><br><span class="line">            LeaveCriticalSection(&amp;_cs);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( _isLog )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">memset</span>(banner, <span class="number">0</span>, <span class="keyword">sizeof</span>(banner));</span><br><span class="line">            <span class="keyword">if</span> ( _isBanner )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="keyword">if</span> ( recvLen )</span><br><span class="line">                wsprintf(banner, <span class="string">&quot;%-16s %-5d -&gt; \&quot;%s\&quot;\r\n&quot;</span>, targetHost, v9, responseBanner);</span><br><span class="line">              <span class="keyword">else</span></span><br><span class="line">                wsprintf(banner, <span class="string">&quot;%-16s %-5d -&gt; NULL\r\n&quot;</span>, targetHost, v9);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">              wsprintf(banner, <span class="string">&quot;%-16s %-5d Open             \r\n&quot;</span>, targetHost, v9);</span><br><span class="line">            &#125;</span><br><span class="line">            EnterCriticalSection(&amp;_cs);</span><br><span class="line">            logWriteBuffer(_logFile, banner);</span><br><span class="line">            LeaveCriticalSection(&amp;_cs);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  EnterCriticalSection(&amp;_cs);</span><br><span class="line">  ++_ipScanned;</span><br><span class="line">  <span class="keyword">if</span> ( _threadsUsed )</span><br><span class="line">    --_threadsUsed;</span><br><span class="line">  ReleaseSemaphore(_semaphore, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  LeaveCriticalSection(&amp;_cs);</span><br><span class="line">  closesocket(s);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">USHORT <span class="title">checkSum</span><span class="params">(<span class="keyword">void</span> * buffer, <span class="keyword">int</span> size)</span> </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">       <span class="keyword">unsigned</span> <span class="keyword">long</span> cksum=<span class="number">0</span>;</span><br><span class="line">       <span class="keyword">while</span> (size &gt;<span class="number">1</span>) &#123;</span><br><span class="line">              cksum += *(USHORT *)buffer;</span><br><span class="line">              size -= <span class="keyword">sizeof</span>(USHORT);</span><br><span class="line">			  buffer = (<span class="keyword">char</span> *)buffer + <span class="keyword">sizeof</span>(USHORT);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">if</span> (size) cksum += *(UCHAR*) buffer;</span><br><span class="line">       cksum = (cksum &gt;&gt; <span class="number">16</span>) + (cksum&amp;<span class="number">0xffff</span>);</span><br><span class="line">       cksum += (cksum &gt;&gt; <span class="number">16</span>);</span><br><span class="line">       <span class="keyword">return</span> (USHORT) (~cksum); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span>	<span class="title">buildSynPacket</span><span class="params">(<span class="keyword">char</span> * buf, u_long saddr, u_long sport, u_long daddr, u_long dport)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span>	len = <span class="number">0</span>;</span><br><span class="line">	IP_HEADER ip_header;   </span><br><span class="line">	TCP_HEADER tcp_header;</span><br><span class="line">	<span class="comment">//填充IP首部    </span></span><br><span class="line">	ip_header.h_lenver=(<span class="number">4</span>&lt;&lt;<span class="number">4</span> | <span class="keyword">sizeof</span>(ip_header)/<span class="keyword">sizeof</span>(<span class="keyword">unsigned</span> <span class="keyword">long</span>));   </span><br><span class="line">	<span class="comment">//高四位IP版本号，低四位首部长度    </span></span><br><span class="line">	ip_header.total_len=htons(<span class="keyword">sizeof</span>(IP_HEADER)+<span class="keyword">sizeof</span>(TCP_HEADER)); <span class="comment">//16位总长度（字节）    </span></span><br><span class="line">	ip_header.ident=<span class="number">1</span>; <span class="comment">//16位标识    </span></span><br><span class="line">	ip_header.frag_and_flags = <span class="number">0</span>; <span class="comment">//3位标志位    </span></span><br><span class="line">	ip_header.ttl = <span class="number">128</span>; <span class="comment">//8位生存时间TTL    </span></span><br><span class="line">	ip_header.proto = IPPROTO_TCP; <span class="comment">//8位协议(TCP,UDP…)    </span></span><br><span class="line">	ip_header.checksum = <span class="number">0</span>; <span class="comment">//16位IP首部校验和    </span></span><br><span class="line">	ip_header.sourceIP = saddr; <span class="comment">//32位源IP地址    </span></span><br><span class="line">	ip_header.destIP = daddr; <span class="comment">//32位目的IP地址    </span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//填充TCP首部    </span></span><br><span class="line">	tcp_header.th_sport = sport; <span class="comment">//源端口号    </span></span><br><span class="line">	tcp_header.th_lenres=(<span class="keyword">sizeof</span>(TCP_HEADER)/<span class="number">4</span>&lt;&lt;<span class="number">4</span>|<span class="number">0</span>); <span class="comment">//TCP长度和保留位    </span></span><br><span class="line">	tcp_header.th_win = htons(<span class="number">0x4000</span>);    </span><br><span class="line">	</span><br><span class="line">	<span class="comment">//填充TCP伪首部（用于计算校验和，并不真正发送）    </span></span><br><span class="line">	psd_header.saddr=ip_header.sourceIP;   </span><br><span class="line">	psd_header.daddr=ip_header.destIP;   </span><br><span class="line">	psd_header.mbz=<span class="number">0</span>;   </span><br><span class="line">	psd_header.ptcl=IPPROTO_TCP;   </span><br><span class="line">	psd_header.tcpl=htons(<span class="keyword">sizeof</span>(tcp_header)); </span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	tcp_header.th_dport = dport; <span class="comment">//目的端口号</span></span><br><span class="line">	tcp_header.th_ack=<span class="number">0</span>; <span class="comment">//ACK序列号置为0</span></span><br><span class="line">	tcp_header.th_flag=<span class="number">2</span>; <span class="comment">//SYN 标志</span></span><br><span class="line">	tcp_header.th_seq = sport <span class="number">-1</span>; <span class="comment">//SYN序列号随机</span></span><br><span class="line">	tcp_header.th_urp=<span class="number">0</span>; <span class="comment">//偏移</span></span><br><span class="line">	tcp_header.th_sum=<span class="number">0</span>; <span class="comment">//校验和</span></span><br><span class="line">	<span class="comment">//计算TCP校验和，计算校验和时需要包括TCP pseudo header </span></span><br><span class="line">	<span class="built_in">memcpy</span>(buf,&amp;psd_header,<span class="keyword">sizeof</span>(psd_header)); </span><br><span class="line">	<span class="built_in">memcpy</span>(buf+<span class="keyword">sizeof</span>(psd_header),&amp;tcp_header,<span class="keyword">sizeof</span>(tcp_header));</span><br><span class="line">	tcp_header.th_sum=checkSum(buf,<span class="keyword">sizeof</span>(psd_header)+<span class="keyword">sizeof</span>(tcp_header));</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//计算IP校验和</span></span><br><span class="line">	<span class="built_in">memcpy</span>(buf,&amp;ip_header,<span class="keyword">sizeof</span>(ip_header));</span><br><span class="line">	<span class="built_in">memcpy</span>(buf+<span class="keyword">sizeof</span>(ip_header),&amp;tcp_header,<span class="keyword">sizeof</span>(tcp_header));</span><br><span class="line">	<span class="built_in">memset</span>(buf+<span class="keyword">sizeof</span>(ip_header)+<span class="keyword">sizeof</span>(tcp_header),<span class="number">0</span>,<span class="number">4</span>);</span><br><span class="line">	len=<span class="keyword">sizeof</span>(ip_header)+<span class="keyword">sizeof</span>(tcp_header);</span><br><span class="line">	ip_header.checksum=checkSum(buf,len);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//填充发送缓冲区</span></span><br><span class="line">	<span class="built_in">memcpy</span>(buf,&amp;ip_header,<span class="keyword">sizeof</span>(ip_header));</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> len;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 有点问题，发出去的数据包不对</span></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="keyword">int</span> <span class="title">synScan</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> Buffer[<span class="number">0x190</span>]; <span class="comment">// [sp+0h] [bp-2C0h]@2</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [sp+140h] [bp-180h]@3</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [sp+150h] [bp-170h]@3</span></span><br><span class="line">  SOCKET s; <span class="comment">// [sp+154h] [bp-16Ch]@3</span></span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">0x100</span>]; <span class="comment">// [sp+198h] [bp-128h]@3</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> optval; <span class="comment">// [sp+13Ch] [bp-184h]@3</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> sendTimeout; <span class="comment">// [sp+138h] [bp-188h]@3</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> portsScanned; <span class="comment">// [sp+170h] [bp-150h]@3</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v15; <span class="comment">// [sp+14Ch] [bp-174h]@3</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v16; <span class="comment">// [sp+148h] [bp-178h]@3</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> dport; <span class="comment">// [sp+178h] [bp-148h]@6</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> counter; <span class="comment">// [sp+174h] [bp-14Ch]@6</span></span><br><span class="line">  u_long hostlong; <span class="comment">// [sp+158h] [bp-168h]@6</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">dst</span>;</span> <span class="comment">// [sp+17Ch] [bp-144h]@9</span></span><br><span class="line">  <span class="keyword">int</span> len; <span class="comment">// [sp+16Ch] [bp-154h]@9</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v49; <span class="comment">// [sp+12Ch] [bp-194h]@11</span></span><br><span class="line">  <span class="keyword">char</span> Dest[<span class="number">0x20</span>]; <span class="comment">// [sp+110h] [bp-1B0h]@37</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  v8 = _portScanSingle;</span><br><span class="line">  v9 = dword_407090;</span><br><span class="line">  s = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">  optval = <span class="number">1</span>;</span><br><span class="line">  sendTimeout = <span class="number">1500</span>;</span><br><span class="line">  portsScanned = <span class="number">0</span>;</span><br><span class="line">  v15 = <span class="number">0</span>;</span><br><span class="line">  v16 = <span class="number">0</span>;</span><br><span class="line">  s = socket(AF_INET, SOCK_RAW, IPPROTO_RAW);</span><br><span class="line">  <span class="keyword">if</span> ( s != <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    optval = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( setsockopt(s, IPPROTO_IP, <span class="number">2</span><span class="comment">/*IP_HDRINCL*/</span>, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;optval, <span class="keyword">sizeof</span>(optval)) != <span class="number">-1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( setsockopt(s, SOL_SOCKET, SO_SNDTIMEO, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;sendTimeout, <span class="keyword">sizeof</span>(sendTimeout)) != <span class="number">-1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        dport = <span class="number">0</span>;</span><br><span class="line">        counter = <span class="number">0</span>;</span><br><span class="line">        hostlong = _startIp;</span><br><span class="line">        <span class="keyword">while</span> ( hostlong &lt;= _endIp )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( _isMultiplePort )</span><br><span class="line">          &#123;</span><br><span class="line">            counter = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> ( counter &lt; _portsTotal )</span><br><span class="line">            &#123;</span><br><span class="line">              dport = *((DWORD *)_portsArray + counter);</span><br><span class="line"></span><br><span class="line">			  <span class="built_in">memset</span>(&amp;dst, <span class="number">0</span>, <span class="keyword">sizeof</span>(dst));</span><br><span class="line"></span><br><span class="line">              dst.sin_family = AF_INET;</span><br><span class="line">              dst.sin_port = htons(dport);</span><br><span class="line">			  dst.sin_addr.s_addr = htonl(hostlong); </span><br><span class="line"></span><br><span class="line">			  len = buildSynPacket(buf, _bindIpAddr, htons(getrandom(<span class="number">1</span>, <span class="number">65535</span>)), dst.sin_addr.s_addr, dst.sin_port);</span><br><span class="line"></span><br><span class="line">              ++_ipScanned;</span><br><span class="line"></span><br><span class="line">              <span class="keyword">if</span> ( sendto(s, buf, len, <span class="number">0</span>, (struct sockaddr *)&amp;dst, <span class="keyword">sizeof</span>(dst)) != <span class="number">-1</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                ++portsScanned;</span><br><span class="line">                EnterCriticalSection(&amp;_cs);</span><br><span class="line">                <span class="keyword">if</span> ( _isRangeScan )</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="built_in">printf</span>(<span class="string">&quot;%u Ports Scanned.              \r&quot;</span>, portsScanned);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                  v49 = portsScanned / _portsTotal;</span><br><span class="line">                  <span class="built_in">printf</span>(<span class="string">&quot;%u IP Scanned.              \r&quot;</span>, portsScanned / _portsTotal);</span><br><span class="line">                &#125;</span><br><span class="line">                LeaveCriticalSection(&amp;_cs);</span><br><span class="line">                <span class="keyword">if</span> ( _isBreak )</span><br><span class="line">                &#123;</span><br><span class="line">                  v15 = hostlong + <span class="number">1</span>;</span><br><span class="line">                  v16 = dport;</span><br><span class="line">                  <span class="keyword">goto</span> __break;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> ( !(portsScanned % <span class="number">1000</span>) )</span><br><span class="line">                  Sleep(<span class="number">0xA</span>u);</span><br><span class="line">              &#125;</span><br><span class="line">              ++counter;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span> <span class="comment">// !_isMultiplePort</span></span><br><span class="line">          &#123;</span><br><span class="line">            v49 = v9 - v8 + <span class="number">1</span>;</span><br><span class="line">            counter = v8;</span><br><span class="line">            <span class="keyword">while</span> ( counter &lt;= v9 )</span><br><span class="line">            &#123;</span><br><span class="line">              dport = counter;</span><br><span class="line"></span><br><span class="line">			  <span class="built_in">memset</span>(&amp;dst, <span class="number">0</span>, <span class="keyword">sizeof</span>(dst));</span><br><span class="line">              dst.sin_family = AF_INET;</span><br><span class="line">              dst.sin_port = htons(dport);</span><br><span class="line">			  dst.sin_addr.s_addr = htonl(hostlong); </span><br><span class="line">			  </span><br><span class="line">			  len = buildSynPacket(buf, _bindIpAddr, htons(getrandom(<span class="number">1</span>, <span class="number">65535</span>)), dst.sin_addr.s_addr, dst.sin_port);</span><br><span class="line"></span><br><span class="line">              ++_ipScanned;</span><br><span class="line">              <span class="keyword">if</span> ( sendto(s, buf, len, <span class="number">0</span>, (struct sockaddr *)&amp;dst, <span class="keyword">sizeof</span>(dst)) != <span class="number">-1</span> )</span><br><span class="line">              &#123;</span><br><span class="line">                ++portsScanned;</span><br><span class="line">                EnterCriticalSection(&amp;_cs);</span><br><span class="line">                <span class="keyword">if</span> ( _isRangeScan )</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="built_in">printf</span>(<span class="string">&quot;%u Ports Scanned.              \r&quot;</span>, portsScanned);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="built_in">printf</span>(<span class="string">&quot;%u IP Scanned.              \r&quot;</span>, portsScanned / v49);</span><br><span class="line">                &#125;</span><br><span class="line">                LeaveCriticalSection(&amp;_cs);</span><br><span class="line">                <span class="keyword">if</span> ( _isBreak )</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="keyword">if</span> ( _isRangeScan )</span><br><span class="line">                    v15 = hostlong;</span><br><span class="line">                  <span class="keyword">else</span></span><br><span class="line">                    v15 = hostlong + <span class="number">1</span>;</span><br><span class="line">                  v16 = dport;</span><br><span class="line">                  <span class="keyword">goto</span> __break;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> ( !(portsScanned % <span class="number">1000</span>) )</span><br><span class="line">                  Sleep(<span class="number">10</span>);</span><br><span class="line">              &#125;</span><br><span class="line">              ++counter;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          ++hostlong;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">__break:</span><br><span class="line">  <span class="keyword">if</span> ( _isBreak )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(Dest, <span class="number">0</span>, <span class="keyword">sizeof</span>(Dest));</span><br><span class="line">    wsprintf(Dest, <span class="string">&quot;%d.%d.%d.%d&quot;</span>, v15 &gt;&gt; <span class="number">24</span>, (v15 &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>, (<span class="keyword">unsigned</span> __int16)((WORD)v15 &gt;&gt; <span class="number">8</span>), (<span class="keyword">unsigned</span> __int8)v15);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Last Scan: %s:%d                \n&quot;</span>, Dest, v16);</span><br><span class="line">    <span class="keyword">if</span> ( _isLog )</span><br><span class="line">    &#123;</span><br><span class="line">      wsprintf(Buffer, <span class="string">&quot;LastIP Scanned: %s:%d\r\n&quot;</span>, &amp;Dest, v16);</span><br><span class="line">      logWriteBuffer(_logFile, (<span class="keyword">char</span> *)Buffer);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( s != <span class="number">-1</span> )</span><br><span class="line">    closesocket(s);</span><br><span class="line"></span><br><span class="line">  EnterCriticalSection(&amp;_cs);</span><br><span class="line">  <span class="keyword">if</span> ( _threadsUsed )</span><br><span class="line">    --_threadsUsed;</span><br><span class="line">  LeaveCriticalSection(&amp;_cs);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//----- (00403FD9) --------------------------------------------------------</span></span><br><span class="line"><span class="function">BOOL <span class="title">buildPortsList</span><span class="params">(<span class="keyword">char</span> * portsList, <span class="keyword">int</span> portsCount)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	BOOL	result; <span class="comment">// eax@4</span></span><br><span class="line">	<span class="keyword">int</span>		port; <span class="comment">// eax@8</span></span><br><span class="line">	<span class="keyword">char</span> *	nextToken; <span class="comment">// eax@5</span></span><br><span class="line">	<span class="keyword">char</span> *	portString; <span class="comment">// [sp+4h] [bp-8h]@5</span></span><br><span class="line"></span><br><span class="line">	_portsArray = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>) * portsCount);</span><br><span class="line"></span><br><span class="line">	result = FALSE;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ( _portsArray )</span><br><span class="line">	&#123;</span><br><span class="line">		nextToken = strtok(portsList, <span class="string">&quot;,&quot;</span>);</span><br><span class="line">		portString = nextToken;</span><br><span class="line">		<span class="keyword">if</span> ( nextToken )</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">while</span> ( portString )</span><br><span class="line">			&#123;</span><br><span class="line">				port = atoi(portString);</span><br><span class="line">				<span class="keyword">if</span> ( port &gt; <span class="number">0</span> )</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">if</span> ( port &lt;= <span class="number">65535</span> )</span><br><span class="line">					&#123;</span><br><span class="line">						*((DWORD *)_portsArray + _portsTotal++) = port;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				portString = strtok(<span class="number">0</span>, <span class="string">&quot;,&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			result = (_portsTotal &gt; <span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//----- (00403F08) --------------------------------------------------------</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getPortsCount</span><span class="params">(<span class="keyword">char</span> * portList)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span>		result; <span class="comment">// eax@4</span></span><br><span class="line">	<span class="keyword">char</span> *	nextToken; <span class="comment">// eax@7</span></span><br><span class="line">	<span class="keyword">char</span> *	buf; <span class="comment">// [sp+4h] [bp-Ch]@5</span></span><br><span class="line">	<span class="keyword">char</span> *	p; <span class="comment">// [sp+Ch] [bp-4h]@7</span></span><br><span class="line">	<span class="keyword">int</span>		count; <span class="comment">// [sp+8h] [bp-8h]@9</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> ( portList )</span><br><span class="line">	&#123;</span><br><span class="line">		buf = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(lstrlen(portList) + <span class="number">16</span>);</span><br><span class="line">		<span class="keyword">if</span> (buf)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">strcpy</span>(buf, portList);</span><br><span class="line">			nextToken = strtok(buf, <span class="string">&quot;,&quot;</span>);</span><br><span class="line">			p = nextToken;</span><br><span class="line">			<span class="keyword">if</span> (nextToken)</span><br><span class="line">			&#123;</span><br><span class="line">				count = <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">while</span> ( p )</span><br><span class="line">				&#123;</span><br><span class="line">					p = strtok(<span class="number">0</span>, <span class="string">&quot;,&quot;</span>);</span><br><span class="line">					count++;</span><br><span class="line">				&#125;</span><br><span class="line">				result = count;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				result = <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">free</span>(buf);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			result = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		result = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//----- (00402A70) --------------------------------------------------------</span></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="keyword">int</span> __cdecl <span class="title">filterPacket</span><span class="params">(<span class="keyword">char</span> * a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> result; <span class="comment">// eax@4</span></span><br><span class="line">  u_long v3; <span class="comment">// eax@5</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v4; <span class="comment">// eax@20</span></span><br><span class="line">  u_short v5; <span class="comment">// ax@20</span></span><br><span class="line">  <span class="keyword">char</span> * v8; <span class="comment">// [sp+144h] [bp-8h]@3</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int16 v9; <span class="comment">// [sp+13Eh] [bp-Eh]@3</span></span><br><span class="line">  <span class="keyword">char</span> * v10; <span class="comment">// [sp+148h] [bp-4h]@3</span></span><br><span class="line">  u_long v11; <span class="comment">// [sp+140h] [bp-Ch]@5</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v12; <span class="comment">// [sp+134h] [bp-18h]@9</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v13; <span class="comment">// [sp+138h] [bp-14h]@9</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v14; <span class="comment">// [sp+130h] [bp-1Ch]@10</span></span><br><span class="line">  <span class="keyword">char</span>	buf[<span class="number">0x20</span>]; <span class="comment">// [sp+110h] [bp-3Ch]@20</span></span><br><span class="line">  <span class="keyword">char</span>	logBuffer[<span class="number">0x100</span>];</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v16; <span class="comment">// [sp+10Ch] [bp-40h]@20</span></span><br><span class="line">  <span class="keyword">int</span> v17; <span class="comment">// [sp+108h] [bp-44h]@20</span></span><br><span class="line">  <span class="keyword">int</span> v18; <span class="comment">// [sp+104h] [bp-48h]@20</span></span><br><span class="line">  <span class="keyword">int</span> v19; <span class="comment">// [sp+100h] [bp-4Ch]@20</span></span><br><span class="line"></span><br><span class="line">  v8 = a1;</span><br><span class="line">  v9 = <span class="number">4</span> * (*(BYTE *)a1 &amp; <span class="number">0xF</span>);</span><br><span class="line">  v10 = a1 + v9;</span><br><span class="line">  <span class="keyword">if</span> ( *(BYTE *)(a1 + v9 + <span class="number">13</span>) == <span class="number">20</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v3 = ntohl(*(DWORD *)(v8 + <span class="number">12</span>));</span><br><span class="line">    v11 = v3;</span><br><span class="line">    <span class="keyword">if</span> ( v3 &gt;= _startIp &amp;&amp; v3 &lt;= _endIp )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *(BYTE *)(v10 + <span class="number">13</span>) != <span class="number">18</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_26;</span><br><span class="line">      v12 = <span class="number">0</span>;</span><br><span class="line">      v13 = ntohs(*(WORD *)v10);</span><br><span class="line">      <span class="keyword">if</span> ( !_isMultiplePort )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v13 &gt;= _portScanSingle )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( v13 &lt;= dword_407090 )</span><br><span class="line">            v12 = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        v14 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> ( v14 &lt; _portsTotal )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( v13 == *((DWORD *)_portsArray + v14) )</span><br><span class="line">            v12 = <span class="number">1</span>;</span><br><span class="line">          ++v14;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( v12 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">        v4 = ntohl(*(DWORD *)(v8 + <span class="number">12</span>));</span><br><span class="line">        v14 = v4;</span><br><span class="line">        v16 = v4 &gt;&gt; <span class="number">24</span>;</span><br><span class="line">        v17 = (v4 &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>;</span><br><span class="line">        v18 = (<span class="keyword">unsigned</span> __int16)((WORD)v4 &gt;&gt; <span class="number">8</span>);</span><br><span class="line">        v19 = (<span class="keyword">unsigned</span> __int8)v4;</span><br><span class="line">        wsprintf(</span><br><span class="line">          buf,</span><br><span class="line">          <span class="string">&quot;%d.%d.%d.%d&quot;</span>,</span><br><span class="line">          v4 &gt;&gt; <span class="number">24</span>,</span><br><span class="line">          (v4 &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>,</span><br><span class="line">          (<span class="keyword">unsigned</span> __int16)((WORD)v4 &gt;&gt; <span class="number">8</span>),</span><br><span class="line">          (<span class="keyword">unsigned</span> __int8)v4);</span><br><span class="line">        EnterCriticalSection(&amp;_cs);</span><br><span class="line">        ++_totalPortsOpen;</span><br><span class="line">        v5 = ntohs(*(WORD *)v10);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%-16s %-5d Open             \n&quot;</span>, buf, v5);</span><br><span class="line">        <span class="keyword">if</span> ( _isLog )</span><br><span class="line">        &#123;</span><br><span class="line">          wsprintf(logBuffer, <span class="string">&quot;%-16s %-5d Open             \r\n&quot;</span>, buf, v5);</span><br><span class="line">          logWriteBuffer(_logFile, logBuffer);</span><br><span class="line">        &#125;</span><br><span class="line">		LeaveCriticalSection(&amp;_cs);</span><br><span class="line">        result = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">LABEL_26:</span><br><span class="line">        result = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      result = <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SIO_RCVALL _WSAIOW(IOC_VENDOR,1) </span></span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">snifferThread</span><span class="params">(LPVOID)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span>	ret;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//设置SOCK_RAW为SIO_RCVALL，以便接收所有的IP包    </span></span><br><span class="line">	<span class="keyword">int</span> optval = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span>	bytesRet;  </span><br><span class="line">	</span><br><span class="line">	SOCKADDR_IN sa; </span><br><span class="line">	_s = socket(AF_INET, SOCK_RAW, IPPROTO_IP);</span><br><span class="line">	<span class="keyword">if</span> (INVALID_SOCKET == _s)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Fail To Create Socket\n&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	sa.sin_family = AF_INET;</span><br><span class="line">	sa.sin_port = htons(<span class="number">0</span>);</span><br><span class="line">	sa.sin_addr.S_un.S_addr = _bindIpAddr;</span><br><span class="line">	</span><br><span class="line">	ret = bind(_s, (struct sockaddr *)&amp;sa, <span class="keyword">sizeof</span>(sa));   </span><br><span class="line">	<span class="keyword">if</span> (INVALID_SOCKET == ret)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Fail To Bind Socket\n&quot;</span>);</span><br><span class="line">		closesocket(_s);</span><br><span class="line">		<span class="keyword">goto</span> __faild;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	ret = WSAIoctl(_s, SIO_RCVALL, (LPVOID)&amp;optval, <span class="keyword">sizeof</span>(optval), <span class="literal">NULL</span>, <span class="number">0</span>, (LPDWORD)&amp;bytesRet, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">char</span>	buff[<span class="number">0xFFFF</span>];</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">memset</span>(buff, <span class="number">0</span>, <span class="keyword">sizeof</span>(buff));</span><br><span class="line">		ret = recv(_s, buff, <span class="keyword">sizeof</span>(buff), <span class="number">0</span>);</span><br><span class="line">		<span class="keyword">if</span> (ret)</span><br><span class="line">		&#123;</span><br><span class="line">			filterPacket(buff);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">while</span> (ret &gt; <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">__faild:	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">u_long <span class="title">getBindIpAddress</span><span class="params">(<span class="keyword">char</span> * dstIpAddr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	u_long	bindAddr = INADDR_NONE;</span><br><span class="line">	DWORD	nInterfaceIndex = <span class="number">0</span>;</span><br><span class="line">	DWORD	index = <span class="number">0</span>;</span><br><span class="line">	PMIB_IPADDRTABLE	ipTable = <span class="literal">NULL</span>;</span><br><span class="line">	ULONG	allocSize = <span class="number">0</span>;</span><br><span class="line">	HRESULT ret;</span><br><span class="line">	</span><br><span class="line">	ret = GetBestInterface( inet_addr(dstIpAddr), &amp;nInterfaceIndex );</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (ret != NO_ERROR)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">goto</span> __exit;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	MIB_IFROW ifRow;</span></span><br><span class="line"><span class="comment">	ifRow.dwIndex = nInterfaceIndex;</span></span><br><span class="line"><span class="comment">	ret = GetIfEntry( &amp;ifRow );</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	  if ( ret != NO_ERROR )</span></span><br><span class="line"><span class="comment">	  &#123;</span></span><br><span class="line"><span class="comment">	  goto __exit;</span></span><br><span class="line"><span class="comment">	  &#125;</span></span><br><span class="line"><span class="comment">	  </span></span><br><span class="line"><span class="comment">		printf(&quot;%s\n&quot;, ifRow.bDescr);</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	</span><br><span class="line">	allocSize = <span class="number">0</span>;	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">	&#123;</span><br><span class="line">		ret = GetIpAddrTable( ipTable, &amp;allocSize, FALSE );</span><br><span class="line">		<span class="keyword">if</span> (ret != NO_ERROR)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (allocSize)</span><br><span class="line">			&#123;</span><br><span class="line">				ipTable = (PMIB_IPADDRTABLE)<span class="built_in">malloc</span>(allocSize);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">while</span> (ret != NO_ERROR);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (index = <span class="number">0</span>; index &lt; ipTable-&gt;dwNumEntries; index++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (ipTable-&gt;table[ index ].dwIndex == nInterfaceIndex)</span><br><span class="line">		&#123;</span><br><span class="line">			bindAddr = ipTable-&gt;table[ index ].dwAddr;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">__exit:</span><br><span class="line">	<span class="keyword">if</span> (ipTable)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">free</span>(ipTable);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> bindAddr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">buildIpRange</span><span class="params">(<span class="keyword">char</span> * startIpAddr, <span class="keyword">char</span> * realStartIpAddr, <span class="keyword">char</span> * realEndIpAddr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span>	startIpStr[<span class="number">256</span>];</span><br><span class="line">	<span class="keyword">char</span>	endIpStr[<span class="number">256</span>];</span><br><span class="line">	<span class="keyword">char</span> *	slash = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="keyword">int</span>		range = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span>		submask = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">memset</span>(startIpStr, <span class="number">0</span>, <span class="keyword">sizeof</span>(startIpStr));</span><br><span class="line">	<span class="built_in">memset</span>(endIpStr, <span class="number">0</span>, <span class="keyword">sizeof</span>(endIpStr));</span><br><span class="line">	</span><br><span class="line">	slash = <span class="built_in">strchr</span>(startIpAddr, <span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span> (slash)</span><br><span class="line">	&#123;</span><br><span class="line">		lstrcpyn(startIpStr, startIpAddr, slash - startIpAddr + <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">int</span> bit = atoi(slash+<span class="number">1</span>);</span><br><span class="line">		range = <span class="number">0xFFFFFFFF</span> &gt;&gt; bit;</span><br><span class="line">		submask = <span class="number">0xFFFFFFFF</span> &lt;&lt; (<span class="number">32</span> - bit);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		lstrcpy(startIpStr, startIpAddr);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 起始IP参数转化(支持域名)</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">hostent</span> * <span class="title">hostInfo</span> = <span class="title">gethostbyname</span>(<span class="title">startIpStr</span>);</span></span><br><span class="line">	<span class="keyword">if</span> (hostInfo)</span><br><span class="line">	&#123;</span><br><span class="line">		lstrcpy(startIpStr, inet_ntoa(*(IN_ADDR*)hostInfo-&gt;h_addr_list[<span class="number">0</span>]));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (submask)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span>	start = (inet_addr(startIpStr) &amp; ntohl(submask)) + ntohl(<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">int</span>	end = (inet_addr(startIpStr) &amp; ntohl(submask)) + ntohl(range<span class="number">-1</span>);</span><br><span class="line">		lstrcpy(endIpStr, inet_ntoa(*(IN_ADDR*)&amp;end));</span><br><span class="line">		lstrcpy(startIpStr, inet_ntoa(*(IN_ADDR*)&amp;start));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (realStartIpAddr)</span><br><span class="line">	&#123;</span><br><span class="line">		lstrcpy(realStartIpAddr, startIpStr);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (realEndIpAddr)</span><br><span class="line">	&#123;</span><br><span class="line">		lstrcpy(realEndIpAddr, endIpStr);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">startScan</span><span class="params">(<span class="keyword">char</span> * scanType, <span class="keyword">char</span> * startIpAddr, <span class="keyword">char</span> * endIpAddr, <span class="keyword">char</span> * portList, <span class="keyword">char</span> *maxThreads)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span>	buf[<span class="number">0x100</span>];</span><br><span class="line">	<span class="keyword">char</span>	lastScan[<span class="number">0x20</span>];</span><br><span class="line">	<span class="keyword">signed</span> <span class="keyword">int</span> v5; <span class="comment">// ecx@1</span></span><br><span class="line">	<span class="keyword">unsigned</span> __int32 v8; <span class="comment">// eax@19</span></span><br><span class="line">	<span class="keyword">unsigned</span> __int32 v9; <span class="comment">// eax@19</span></span><br><span class="line">	<span class="keyword">unsigned</span> __int32 startIp; <span class="comment">// eax@23</span></span><br><span class="line">	<span class="keyword">int</span> v11; <span class="comment">// eax@26</span></span><br><span class="line">	<span class="keyword">int</span> v12; <span class="comment">// eax@27</span></span><br><span class="line">	<span class="keyword">int</span> v13; <span class="comment">// eax@35</span></span><br><span class="line">	HANDLE threadSniffer; <span class="comment">// eax@62</span></span><br><span class="line">	HANDLE v17; <span class="comment">// eax@120</span></span><br><span class="line">	<span class="keyword">void</span> *param; <span class="comment">// eax@129</span></span><br><span class="line">	DWORD v20; <span class="comment">// eax@149</span></span><br><span class="line">	<span class="keyword">int</span> v21; <span class="comment">// eax@160</span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> v22; <span class="comment">// ecx@177</span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> v23; <span class="comment">// [sp+0h] [bp-27Ch]@2</span></span><br><span class="line">	<span class="keyword">signed</span> <span class="keyword">int</span> isSynScan; <span class="comment">// [sp+260h] [bp-1Ch]@3</span></span><br><span class="line">	<span class="keyword">int</span> v25; <span class="comment">// [sp+28h] [bp-254h]@3</span></span><br><span class="line">	<span class="keyword">int</span> v26; <span class="comment">// [sp+26Ch] [bp-10h]@3</span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> lastPortScan; <span class="comment">// [sp+268h] [bp-14h]@3</span></span><br><span class="line">	BOOL v29; <span class="comment">// [sp+264h] [bp-18h]@3</span></span><br><span class="line">	<span class="keyword">int</span> count; <span class="comment">// [sp+270h] [bp-Ch]@3</span></span><br><span class="line">	<span class="keyword">int</span> currentIp; <span class="comment">// [sp+14h] [bp-268h]@26</span></span><br><span class="line">	DWORD timeStart; <span class="comment">// [sp+4Ch] [bp-230h]@60</span></span><br><span class="line">	DWORD ThreadId; <span class="comment">// [sp+274h] [bp-8h]@62</span></span><br><span class="line">	HANDLE hObject; <span class="comment">// [sp+278h] [bp-4h]@62</span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> v37; <span class="comment">// [sp+10h] [bp-26Ch]@116</span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> portIndex; <span class="comment">// [sp+Ch] [bp-270h]@118</span></span><br><span class="line">	LPVOID lpParameter; <span class="comment">// [sp+8h] [bp-274h]@119</span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> v45; <span class="comment">// [sp+25Ch] [bp-20h]@160</span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> hoursElapsed; <span class="comment">// [sp+58h] [bp-224h]@162</span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> minutesElapsed; <span class="comment">// [sp+54h] [bp-228h]@162</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> secondsElapsed; <span class="comment">// [sp+50h] [bp-22Ch]@162</span></span><br><span class="line"></span><br><span class="line">  LONG previousCount;</span><br><span class="line">  <span class="keyword">char</span>	realStartIpAddr[<span class="number">200</span>];</span><br><span class="line">  <span class="keyword">char</span>	realEndIpAddr[<span class="number">200</span>];</span><br><span class="line"></span><br><span class="line">	isSynScan = <span class="number">0</span>;</span><br><span class="line">	v5 = <span class="number">159</span>;</span><br><span class="line">	v25 = <span class="number">0</span>;</span><br><span class="line">	v26 = <span class="number">0</span>;</span><br><span class="line">	lastPortScan = <span class="number">0</span>;</span><br><span class="line">	v29 = <span class="number">0</span>;</span><br><span class="line">	count = <span class="number">0</span>;</span><br><span class="line">	_portsTotal = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ( !initWinsock() )</span><br><span class="line">    &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Fail To Init Socket\n&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">		</span><br><span class="line">	<span class="comment">// www.shangdu.com/24 1.1.1.1/16</span></span><br><span class="line">	<span class="comment">//////////////////////////////////////////////////////////////////////////</span></span><br><span class="line">	<span class="built_in">memset</span>(realStartIpAddr, <span class="number">0</span>, <span class="keyword">sizeof</span>(realStartIpAddr));</span><br><span class="line">	<span class="built_in">memset</span>(realEndIpAddr, <span class="number">0</span>, <span class="keyword">sizeof</span>(realEndIpAddr));</span><br><span class="line">	<span class="keyword">if</span> (endIpAddr)</span><br><span class="line">	&#123;</span><br><span class="line">		lstrcpy(realEndIpAddr, endIpAddr);</span><br><span class="line">	&#125;</span><br><span class="line">	buildIpRange(startIpAddr, realStartIpAddr, realEndIpAddr);</span><br><span class="line">	startIpAddr = realStartIpAddr;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (lstrlen(realEndIpAddr) &gt; <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		endIpAddr = realEndIpAddr;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">memset</span>(lastScan, <span class="number">0</span>, <span class="keyword">sizeof</span>(lastScan));</span><br><span class="line">	<span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf));</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ( lstrcmpi(scanType, <span class="string">&quot;SYN&quot;</span>) &amp;&amp; lstrcmpi(scanType, <span class="string">&quot;TCP&quot;</span>) )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Invalid Scan Type\n&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> ( lstrcmpi(scanType, <span class="string">&quot;SYN&quot;</span>) )</span><br><span class="line">	&#123;</span><br><span class="line">		_maxThreads = atoi(maxThreads);</span><br><span class="line">		<span class="keyword">if</span> ( !_maxThreads || (<span class="keyword">unsigned</span> <span class="keyword">int</span>)_maxThreads &gt; <span class="number">0x400</span> )</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;Max Thread Out Of Bound\n&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		isSynScan = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> ( !isWin2K() )</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;SYN Scan Can Only Perform On WIN 2K Or Above\n&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		_maxThreads = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (!endIpAddr)</span><br><span class="line">	&#123;</span><br><span class="line">		_isRangeScan = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> ( !<span class="built_in">strstr</span>(portList, <span class="string">&quot;-&quot;</span>) )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ( !<span class="built_in">strstr</span>(portList, <span class="string">&quot;,&quot;</span>) )</span><br><span class="line">			_isSinglePort = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> ( _isRangeScan )</span><br><span class="line">	&#123;</span><br><span class="line">		startIp = inet_addr(startIpAddr);</span><br><span class="line">		_startIp = ntohl(startIp);</span><br><span class="line">		_endIp = _startIp;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		v8 = inet_addr(startIpAddr);</span><br><span class="line">		_startIp = ntohl(v8);</span><br><span class="line">		v9 = inet_addr(endIpAddr);</span><br><span class="line">		_endIp = ntohl(v9);</span><br><span class="line">		<span class="keyword">if</span> ( _startIp &gt; _endIp )</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;Invalid Hosts To Scan\n&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> ( _endIp == _startIp )</span><br><span class="line">			_isRangeScan = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (!_isSinglePort)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//////////////////////////////////////////////////////////////////////////</span></span><br><span class="line">		<span class="keyword">if</span> ( <span class="built_in">strstr</span>(portList, <span class="string">&quot;-&quot;</span>) )</span><br><span class="line">		&#123;</span><br><span class="line">			v11 = (<span class="keyword">int</span>)strtok(portList, <span class="string">&quot;-&quot;</span>);</span><br><span class="line">			currentIp = v11;</span><br><span class="line">			<span class="keyword">if</span> ( !v11 )</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;Something Wrong About The Ports\n&quot;</span>);</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			_portScanSingle = atoi((<span class="keyword">const</span> <span class="keyword">char</span> *)currentIp);</span><br><span class="line">			v12 = (<span class="keyword">int</span>)strtok(<span class="number">0</span>, <span class="string">&quot;-&quot;</span>);</span><br><span class="line">			currentIp = v12;</span><br><span class="line">			<span class="keyword">if</span> ( v12 )</span><br><span class="line">				dword_407090 = atoi((<span class="keyword">const</span> <span class="keyword">char</span> *)currentIp);</span><br><span class="line">			<span class="keyword">if</span> ( !_portScanSingle || (<span class="keyword">unsigned</span> <span class="keyword">int</span>)dword_407090 &gt; <span class="number">0xFFFF</span> || _portScanSingle &gt; (<span class="keyword">unsigned</span> <span class="keyword">int</span>)dword_407090 )</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;Invalid Port To Scan\n&quot;</span>);</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> ( !<span class="built_in">strstr</span>(portList, <span class="string">&quot;,&quot;</span>) )</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;Invalid Port List\n&quot;</span>);</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			v13 = getPortsCount(portList);</span><br><span class="line">			currentIp = v13;</span><br><span class="line">			<span class="keyword">if</span> ( !v13 )</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;No Port To Scan\n&quot;</span>);</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			_isMultiplePort = buildPortsList(portList, currentIp);</span><br><span class="line">			<span class="keyword">if</span> ( _isMultiplePort )</span><br><span class="line">			&#123;</span><br><span class="line">				_isSinglePort = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)_portsTotal &lt;= <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    _portToScan = atoi(portList);</span><br><span class="line">    <span class="keyword">if</span> ( !_portToScan || _portToScan &gt; <span class="number">0xFFFF</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Invalid Port To Scan\n&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    _portScanSingle = _portToScan;</span><br><span class="line">    dword_407090 = _portToScan;</span><br><span class="line">  &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !isSynScan )</span><br><span class="line">    &#123;</span><br><span class="line">      _semaphore = CreateSemaphoreA(<span class="number">0</span>, _maxThreads, _maxThreads, <span class="number">0</span>);</span><br><span class="line">      <span class="keyword">if</span> ( !_semaphore )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Fail To Create Semaphore\n&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> ( _portsArray )</span><br><span class="line">          <span class="built_in">free</span>(_portsArray);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">	_bindIpAddr = getBindIpAddress(startIpAddr);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (INADDR_NONE == _bindIpAddr)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">goto</span> __faild;</span><br><span class="line">	&#125;</span><br><span class="line">    timeStart = GetTickCount();</span><br><span class="line">    <span class="keyword">if</span> ( isSynScan )</span><br><span class="line">    &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Bind On IP: %d.%d.%d.%d\n\n&quot;</span>, (_bindIpAddr &amp; <span class="number">0x0000ff</span>),</span><br><span class="line">			((_bindIpAddr &amp; <span class="number">0x00ff00</span>) &gt;&gt; <span class="number">8</span>), ((_bindIpAddr &amp; <span class="number">0xff0000</span> ) &gt;&gt; <span class="number">16</span>),	(_bindIpAddr &gt;&gt; <span class="number">24</span>));</span><br><span class="line"></span><br><span class="line">		threadSniffer = CreateThread(<span class="number">0</span>, <span class="number">0</span>, snifferThread, <span class="number">0</span>, <span class="number">0</span>, &amp;ThreadId);</span><br><span class="line">		hObject = threadSniffer;</span><br><span class="line">		<span class="keyword">if</span> (<span class="literal">NULL</span> == threadSniffer)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">goto</span> __faild;</span><br><span class="line">		&#125;</span><br><span class="line">      CloseHandle(hObject);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( _isLog )</span><br><span class="line">    &#123;</span><br><span class="line">      logWriteBuffer(_logFile, <span class="string">&quot;-------------------------------------------------------------------------------\r\n&quot;</span>);</span><br><span class="line">      logWriteTime(_logFile);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( _isRangeScan || _isSinglePort )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (!_isRangeScan) &amp; _isSinglePort )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( isSynScan )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">printf</span>(<span class="string">&quot;SYN Scan: About To Scan %u IP Using %d Thread\n&quot;</span>, _endIp - _startIp + <span class="number">1</span>, _maxThreads);</span><br><span class="line">          <span class="keyword">if</span> ( _isLog )</span><br><span class="line">          &#123;</span><br><span class="line">            wsprintf(</span><br><span class="line">              buf,</span><br><span class="line">              <span class="string">&quot;SYN Scan: About To Scan %u IP Using %d Thread\r\n&quot;</span>,</span><br><span class="line">              _endIp - _startIp + <span class="number">1</span>,</span><br><span class="line">              _maxThreads);</span><br><span class="line">            logWriteBuffer(_logFile, buf);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">printf</span>(<span class="string">&quot;Normal Scan: About To Scan %u IP Using %d Threads\n&quot;</span>, _endIp - _startIp + <span class="number">1</span>, _maxThreads);</span><br><span class="line">          <span class="keyword">if</span> ( _isLog )</span><br><span class="line">          &#123;</span><br><span class="line">            wsprintf(</span><br><span class="line">              buf,</span><br><span class="line">              <span class="string">&quot;Normal Scan: About To Scan %u IP Using %d Threads\r\n&quot;</span>,</span><br><span class="line">              _endIp - _startIp + <span class="number">1</span>,</span><br><span class="line">              _maxThreads);</span><br><span class="line">            logWriteBuffer(_logFile, buf);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (!_isRangeScan || _isSinglePort) )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( _isRangeScan )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( _isSinglePort )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="keyword">if</span> ( isSynScan )</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="keyword">if</span> ( _isMultiplePort )</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="built_in">printf</span>(<span class="string">&quot;SYN Scan: About To Scan %s:%d Using %d Thread\n&quot;</span>, startIpAddr, *(DWORD *)_portsArray, _maxThreads);</span><br><span class="line">                  <span class="keyword">if</span> ( _isLog )</span><br><span class="line">                  &#123;</span><br><span class="line">                    wsprintf(</span><br><span class="line">                      buf,</span><br><span class="line">                      <span class="string">&quot;SYN Scan: About To Scan %s:%d Using %d Thread\r\n&quot;</span>,</span><br><span class="line">                      startIpAddr,</span><br><span class="line">                      *(DWORD *)_portsArray,</span><br><span class="line">                      _maxThreads);</span><br><span class="line">                    logWriteBuffer(_logFile, buf);</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="built_in">printf</span>(<span class="string">&quot;SYN Scan: About To Scan %s:%d Using %d Thread\n&quot;</span>, startIpAddr, _portScanSingle, _maxThreads);</span><br><span class="line">                  <span class="keyword">if</span> ( _isLog )</span><br><span class="line">                  &#123;</span><br><span class="line">                    wsprintf(</span><br><span class="line">                      buf,</span><br><span class="line">                      <span class="string">&quot;SYN Scan: About To Scan %s:%d Using %d Thread\r\n&quot;</span>,</span><br><span class="line">                      startIpAddr,</span><br><span class="line">                      _portScanSingle,</span><br><span class="line">                      _maxThreads);</span><br><span class="line">                    logWriteBuffer(_logFile, buf);</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">else</span></span><br><span class="line">              &#123;</span><br><span class="line">                <span class="keyword">if</span> ( _isMultiplePort )</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="built_in">printf</span>(<span class="string">&quot;Normal Scan: About To Scan %s:%d Using %d Thread\n&quot;</span>, startIpAddr, *(DWORD *)_portsArray, _maxThreads);</span><br><span class="line">                  <span class="keyword">if</span> ( _isLog )</span><br><span class="line">                  &#123;</span><br><span class="line">                    wsprintf(</span><br><span class="line">                      buf,</span><br><span class="line">                      <span class="string">&quot;Normal Scan: About To Scan %s:%d Using %d Thread\r\n&quot;</span>,</span><br><span class="line">                      startIpAddr,</span><br><span class="line">                      *(DWORD *)_portsArray,</span><br><span class="line">                      _maxThreads);</span><br><span class="line">                    logWriteBuffer(_logFile, buf);</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="built_in">printf</span>(<span class="string">&quot;Normal Scan: About To Scan %s:%d Using %d Thread\n&quot;</span>, startIpAddr, _portScanSingle, _maxThreads);</span><br><span class="line">                  <span class="keyword">if</span> ( _isLog )</span><br><span class="line">                  &#123;</span><br><span class="line">                    wsprintf(</span><br><span class="line">                      buf,</span><br><span class="line">                      <span class="string">&quot;Normal Scan: About To Scan %s:%d Using %d Thread\r\n&quot;</span>,</span><br><span class="line">                      startIpAddr,</span><br><span class="line">                      _portScanSingle,</span><br><span class="line">                      _maxThreads);</span><br><span class="line">                    logWriteBuffer(_logFile, buf);</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( isSynScan )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( _isMultiplePort )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="built_in">printf</span>(<span class="string">&quot;SYN Scan: About To Scan %u Ports Using %d Thread\n&quot;</span>, _portsTotal, _maxThreads);</span><br><span class="line">              <span class="keyword">if</span> ( _isLog )</span><br><span class="line">              &#123;</span><br><span class="line">                wsprintf(buf, <span class="string">&quot;SYN Scan: About To Scan %u Ports Using %d Thread\r\n&quot;</span>, _portsTotal, _maxThreads);</span><br><span class="line">                logWriteBuffer(_logFile, buf);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">              <span class="built_in">printf</span>(</span><br><span class="line">                <span class="string">&quot;SYN Scan: About To Scan %u Ports Using %d Thread\n&quot;</span>,</span><br><span class="line">                dword_407090 - _portScanSingle + <span class="number">1</span>,</span><br><span class="line">                _maxThreads);</span><br><span class="line">              <span class="keyword">if</span> ( _isLog )</span><br><span class="line">              &#123;</span><br><span class="line">                wsprintf(</span><br><span class="line">                  buf,</span><br><span class="line">                  <span class="string">&quot;SYN Scan: About To Scan %u Ports Using %d Thread\r\n&quot;</span>,</span><br><span class="line">                  dword_407090 - _portScanSingle + <span class="number">1</span>,</span><br><span class="line">                  _maxThreads);</span><br><span class="line">                logWriteBuffer(_logFile, buf);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( _isMultiplePort )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="built_in">printf</span>(<span class="string">&quot;Normal Scan: About To Scan %u Ports Using %d Thread\n&quot;</span>, _portsTotal, _maxThreads);</span><br><span class="line">              <span class="keyword">if</span> ( _isLog )</span><br><span class="line">              &#123;</span><br><span class="line">                wsprintf(buf, <span class="string">&quot;Normal Scan: About To Scan %u Ports Using %d Thread\r\n&quot;</span>, _portsTotal, _maxThreads);</span><br><span class="line">                logWriteBuffer(_logFile, buf);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">              <span class="built_in">printf</span>(</span><br><span class="line">                <span class="string">&quot;Normal Scan: About To Scan %u Ports Using %d Thread\n&quot;</span>,</span><br><span class="line">                dword_407090 - _portScanSingle + <span class="number">1</span>,</span><br><span class="line">                _maxThreads);</span><br><span class="line">              <span class="keyword">if</span> ( _isLog )</span><br><span class="line">              &#123;</span><br><span class="line">                wsprintf(</span><br><span class="line">                  buf,</span><br><span class="line">                  <span class="string">&quot;Normal Scan: About To Scan %u Ports Using %d Thread\r\n&quot;</span>,</span><br><span class="line">                  dword_407090 - _portScanSingle + <span class="number">1</span>,</span><br><span class="line">                  _maxThreads);</span><br><span class="line">                logWriteBuffer(_logFile, buf);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( isSynScan )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( _isMultiplePort )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">printf</span>(</span><br><span class="line">            <span class="string">&quot;SYN Scan: About To Scan %u IP For %u Ports Using %d Thread\n&quot;</span>,</span><br><span class="line">            _endIp - _startIp + <span class="number">1</span>,</span><br><span class="line">            _portsTotal,</span><br><span class="line">            _maxThreads);</span><br><span class="line">          <span class="keyword">if</span> ( _isLog )</span><br><span class="line">          &#123;</span><br><span class="line">            wsprintf(</span><br><span class="line">              buf,</span><br><span class="line">              <span class="string">&quot;SYN Scan: About To Scan %u IP For %u Ports Using %d Thread\r\n&quot;</span>,</span><br><span class="line">              _endIp - _startIp + <span class="number">1</span>,</span><br><span class="line">              _portsTotal,</span><br><span class="line">              _maxThreads);</span><br><span class="line">            logWriteBuffer(_logFile, buf);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">printf</span>(</span><br><span class="line">            <span class="string">&quot;SYN Scan: About To Scan %u IP For %u Ports Using %d Thread\n&quot;</span>,</span><br><span class="line">            _endIp - _startIp + <span class="number">1</span>,</span><br><span class="line">            dword_407090 - _portScanSingle + <span class="number">1</span>,</span><br><span class="line">            _maxThreads);</span><br><span class="line">          <span class="keyword">if</span> ( _isLog )</span><br><span class="line">          &#123;</span><br><span class="line">            wsprintf(</span><br><span class="line">              buf,</span><br><span class="line">              <span class="string">&quot;SYN Scan: About To Scan %u IP For %u Ports Using %d Thread\r\n&quot;</span>,</span><br><span class="line">              _endIp - _startIp + <span class="number">1</span>,</span><br><span class="line">              dword_407090 - _portScanSingle + <span class="number">1</span>,</span><br><span class="line">              _maxThreads);</span><br><span class="line">            logWriteBuffer(_logFile, buf);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( _isMultiplePort )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">printf</span>(</span><br><span class="line">            <span class="string">&quot;Normal Scan: About To Scan %u IP For %u Ports Using %d Thread\n&quot;</span>,</span><br><span class="line">            _endIp - _startIp + <span class="number">1</span>,</span><br><span class="line">            _portsTotal,</span><br><span class="line">            _maxThreads);</span><br><span class="line">          <span class="keyword">if</span> ( _isLog )</span><br><span class="line">          &#123;</span><br><span class="line">            wsprintf(</span><br><span class="line">              buf,</span><br><span class="line">              <span class="string">&quot;Normal Scan: About To Scan %u IP For %u Ports Using %d Thread\r\n&quot;</span>,</span><br><span class="line">              _endIp - _startIp + <span class="number">1</span>,</span><br><span class="line">              _portsTotal,</span><br><span class="line">              _maxThreads);</span><br><span class="line">            logWriteBuffer(_logFile, buf);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">printf</span>(</span><br><span class="line">            <span class="string">&quot;Normal Scan: About To Scan %u IP For %u Ports Using %d Thread\n&quot;</span>,</span><br><span class="line">            _endIp - _startIp + <span class="number">1</span>,</span><br><span class="line">            dword_407090 - _portScanSingle + <span class="number">1</span>,</span><br><span class="line">            _maxThreads);</span><br><span class="line">          <span class="keyword">if</span> ( _isLog )</span><br><span class="line">          &#123;</span><br><span class="line">            wsprintf(</span><br><span class="line">              buf,</span><br><span class="line">              <span class="string">&quot;Normal Scan: About To Scan %u IP For %u Ports Using %d Thread\r\n&quot;</span>,</span><br><span class="line">              _endIp - _startIp + <span class="number">1</span>,</span><br><span class="line">              dword_407090 - _portScanSingle + <span class="number">1</span>,</span><br><span class="line">              _maxThreads);</span><br><span class="line">            logWriteBuffer(_logFile, buf);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( isSynScan )</span><br><span class="line">    &#123;</span><br><span class="line">      ++_threadsUsed;</span><br><span class="line">      synScan();</span><br><span class="line">      <span class="keyword">goto</span> LABEL_147;</span><br><span class="line">    &#125;</span><br><span class="line">    v37 = <span class="number">0</span>;</span><br><span class="line">    currentIp = _startIp;</span><br><span class="line">    <span class="keyword">while</span> ( currentIp &lt;= _endIp )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( _isMultiplePort )</span><br><span class="line">      &#123;</span><br><span class="line">        portIndex = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> ( portIndex &lt; _portsTotal )</span><br><span class="line">        &#123;</span><br><span class="line">          lpParameter = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(DWORD) * <span class="number">2</span>);</span><br><span class="line">          <span class="keyword">if</span> ( lpParameter )</span><br><span class="line">          &#123;</span><br><span class="line">            *(DWORD *)lpParameter = currentIp;</span><br><span class="line">            *((DWORD *)lpParameter + <span class="number">1</span>) = *((DWORD *)_portsArray + portIndex);</span><br><span class="line"></span><br><span class="line">            v17 = CreateThread(<span class="number">0</span>, <span class="number">0</span>, tcpScanThread, lpParameter, <span class="number">0</span>, &amp;ThreadId);</span><br><span class="line">            hObject = v17;</span><br><span class="line">            <span class="keyword">if</span> ( v17 )</span><br><span class="line">            &#123;</span><br><span class="line">              EnterCriticalSection(&amp;_cs);</span><br><span class="line">              <span class="built_in">printf</span>(<span class="string">&quot;%u IP Scanned.Taking %d Threads \r&quot;</span>, _ipScanned / (<span class="keyword">unsigned</span> <span class="keyword">int</span>)_portsTotal, _threadsUsed++);</span><br><span class="line">              ++count;</span><br><span class="line">              LeaveCriticalSection(&amp;_cs);</span><br><span class="line">              CloseHandle(hObject);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( _isBreak )</span><br><span class="line">            &#123;</span><br><span class="line">              v26 = currentIp + <span class="number">1</span>;</span><br><span class="line">              lastPortScan = *((DWORD *)_portsArray + portIndex);</span><br><span class="line">              v37 = <span class="number">1</span>;</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            WaitForSingleObject(_semaphore, INFINITE);</span><br><span class="line">          &#125;</span><br><span class="line">          ++portIndex;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        lpParameter = (LPVOID)(dword_407090 - _portScanSingle + <span class="number">1</span>);</span><br><span class="line">        portIndex = _portScanSingle;</span><br><span class="line">        <span class="keyword">while</span> ( portIndex &lt;= dword_407090 )</span><br><span class="line">        &#123;</span><br><span class="line">          param = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(DWORD) * <span class="number">2</span>);</span><br><span class="line">          <span class="keyword">if</span> ( param )</span><br><span class="line">          &#123;</span><br><span class="line">            *(DWORD *)param = currentIp;</span><br><span class="line">			*((DWORD *)param + <span class="number">1</span>) = portIndex;</span><br><span class="line">            hObject = CreateThread(<span class="number">0</span>, <span class="number">0</span>, tcpScanThread, (LPVOID)param, <span class="number">0</span>, &amp;ThreadId);</span><br><span class="line">            <span class="keyword">if</span> ( hObject )</span><br><span class="line">            &#123;</span><br><span class="line">              EnterCriticalSection(&amp;_cs);</span><br><span class="line">              <span class="keyword">if</span> ( _isRangeScan )</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="keyword">if</span> ( !_isSinglePort )</span><br><span class="line">                  <span class="built_in">printf</span>(<span class="string">&quot;%u Ports Scanned.Taking %d Threads \r&quot;</span>, _ipScanned, _threadsUsed);</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">else</span></span><br><span class="line">              &#123;</span><br><span class="line">                v23 = _ipScanned / (<span class="keyword">unsigned</span> <span class="keyword">int</span>)lpParameter;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%u IP Scanned.Taking %d Threads \r&quot;</span>, _ipScanned / (<span class="keyword">unsigned</span> <span class="keyword">int</span>)lpParameter, _threadsUsed);</span><br><span class="line">              &#125;</span><br><span class="line">              ++_threadsUsed;</span><br><span class="line">              ++count;</span><br><span class="line">              LeaveCriticalSection(&amp;_cs);</span><br><span class="line">              CloseHandle(hObject);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ( _isBreak )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="keyword">if</span> ( _isRangeScan )</span><br><span class="line">                v26 = currentIp;</span><br><span class="line">              <span class="keyword">else</span></span><br><span class="line">                v26 = currentIp + <span class="number">1</span>;</span><br><span class="line">              lastPortScan = portIndex;</span><br><span class="line">              v37 = <span class="number">1</span>;</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            WaitForSingleObject(_semaphore, INFINITE);</span><br><span class="line">          &#125;</span><br><span class="line">          ++portIndex;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( v37 )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      ++currentIp;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_147:</span><br><span class="line">    <span class="keyword">while</span> ( _threadsUsed )</span><br><span class="line">    &#123;</span><br><span class="line">      WaitForSingleObject(_semaphore, INFINITE);</span><br><span class="line">      EnterCriticalSection(&amp;_cs);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d Threads Are In Process......              \r&quot;</span>, _threadsUsed);</span><br><span class="line">      v29 = ReleaseSemaphore(_semaphore, <span class="number">1</span>, &amp;previousCount);</span><br><span class="line">      LeaveCriticalSection(&amp;_cs);</span><br><span class="line">      <span class="keyword">if</span> ( !v29 )</span><br><span class="line">      &#123;</span><br><span class="line">        v20 = GetLastError();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Error Code: %d\n&quot;</span>, v20);</span><br><span class="line">        Sleep(<span class="number">3000</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( previousCount + <span class="number">1</span> != _maxThreads )</span><br><span class="line">      &#123;</span><br><span class="line">        Sleep(<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">if</span> ( isSynScan )</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> ( _ipScanned != count )</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( isSynScan )</span><br><span class="line">      Sleep(<span class="number">500</span>);</span><br><span class="line">    <span class="keyword">if</span> ( !isSynScan )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( _isBreak )</span><br><span class="line">      &#123;</span><br><span class="line">        wsprintf(</span><br><span class="line">          lastScan,</span><br><span class="line">          <span class="string">&quot;%d.%d.%d.%d&quot;</span>,</span><br><span class="line">          (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v26 &gt;&gt; <span class="number">24</span>,</span><br><span class="line">          ((<span class="keyword">unsigned</span> <span class="keyword">int</span>)v26 &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>,</span><br><span class="line">          (<span class="keyword">unsigned</span> __int16)((WORD)v26 &gt;&gt; <span class="number">8</span>),</span><br><span class="line">          (<span class="keyword">unsigned</span> __int8)v26);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Last Scan: %s:%d                \n&quot;</span>, &amp;lastScan, lastPortScan);</span><br><span class="line">        <span class="keyword">if</span> ( _isLog )</span><br><span class="line">        &#123;</span><br><span class="line">          wsprintf(buf, <span class="string">&quot;LastIP Scanned: %s:%d\r\n&quot;</span>, &amp;lastScan, lastPortScan);</span><br><span class="line">          logWriteBuffer(_logFile, buf);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v21 = (GetTickCount() - timeStart) / <span class="number">0x3E8</span>;</span><br><span class="line">    currentIp = v21;</span><br><span class="line">    v45 = v21;</span><br><span class="line">    <span class="keyword">if</span> ( !v21 )</span><br><span class="line">      ++v45;</span><br><span class="line">    v37 = v45 % <span class="number">0x15180</span> / <span class="number">0xE10</span>;</span><br><span class="line">    hoursElapsed = v45 % <span class="number">0x15180</span> / <span class="number">0xE10</span>;</span><br><span class="line">    portIndex = v45 % <span class="number">0x15180</span> % <span class="number">0xE10</span> / <span class="number">0x3C</span>;</span><br><span class="line">    minutesElapsed = v45 % <span class="number">0x15180</span> % <span class="number">0xE10</span> / <span class="number">0x3C</span>;</span><br><span class="line">    secondsElapsed = v45 % <span class="number">0x15180</span> % <span class="number">0xE10</span> % <span class="number">0x3C</span>;</span><br><span class="line">    <span class="keyword">if</span> ( _isBreak )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( _isRangeScan )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(</span><br><span class="line">          <span class="string">&quot;Scan %s Complete In %d Hours %d Minutes %d Seconds. Found %u Open Ports\n&quot;</span>,</span><br><span class="line">          startIpAddr,</span><br><span class="line">          hoursElapsed,</span><br><span class="line">          minutesElapsed,</span><br><span class="line">          secondsElapsed,</span><br><span class="line">          _totalPortsOpen);</span><br><span class="line">        <span class="keyword">if</span> ( _isLog )</span><br><span class="line">        &#123;</span><br><span class="line">          wsprintf(</span><br><span class="line">            buf,</span><br><span class="line">            <span class="string">&quot;Scan %s Complete In %d Hours %d Minutes %d Seconds. Found %u Open Ports\r\n&quot;</span>,</span><br><span class="line">            startIpAddr,</span><br><span class="line">            hoursElapsed,</span><br><span class="line">            minutesElapsed,</span><br><span class="line">            secondsElapsed,</span><br><span class="line">            _totalPortsOpen);</span><br><span class="line">          logWriteBuffer(_logFile, buf);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( _isSinglePort )</span><br><span class="line">        &#123;</span><br><span class="line">          lpParameter = (LPVOID)_ipScanned;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( _isMultiplePort )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( _portsTotal )</span><br><span class="line">            &#123;</span><br><span class="line">              lpParameter = (LPVOID)(_ipScanned / (<span class="keyword">unsigned</span> <span class="keyword">int</span>)_portsTotal);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">              lpParameter = (LPVOID)_ipScanned;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            v22 = dword_407090 - _portScanSingle + <span class="number">1</span>;</span><br><span class="line">            lpParameter = (LPVOID)(_ipScanned / v22);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(</span><br><span class="line">          <span class="string">&quot;Scan %u IPs Complete In %d Hours %d Minutes %d Seconds. Found %u Hosts\n&quot;</span>,</span><br><span class="line">          lpParameter,</span><br><span class="line">          hoursElapsed,</span><br><span class="line">          minutesElapsed,</span><br><span class="line">          secondsElapsed,</span><br><span class="line">          _totalPortsOpen);</span><br><span class="line">        <span class="keyword">if</span> ( _isLog )</span><br><span class="line">        &#123;</span><br><span class="line">          wsprintf(</span><br><span class="line">            buf,</span><br><span class="line">            <span class="string">&quot;Scan %u IPs Complete In %d Hours %d Minutes %d Seconds. Found %u Hosts\r\n&quot;</span>,</span><br><span class="line">            lpParameter,</span><br><span class="line">            hoursElapsed,</span><br><span class="line">            minutesElapsed,</span><br><span class="line">            secondsElapsed,</span><br><span class="line">            _totalPortsOpen);</span><br><span class="line">          logWriteBuffer(_logFile, buf);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( _isRangeScan )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(</span><br><span class="line">          <span class="string">&quot;Scan %s Complete In %d Hours %d Minutes %d Seconds. Found %u Open Ports\n&quot;</span>,</span><br><span class="line">          startIpAddr,</span><br><span class="line">          hoursElapsed,</span><br><span class="line">          minutesElapsed,</span><br><span class="line">          secondsElapsed,</span><br><span class="line">          _totalPortsOpen);</span><br><span class="line">        <span class="keyword">if</span> ( _isLog )</span><br><span class="line">        &#123;</span><br><span class="line">          wsprintf(</span><br><span class="line">            buf,</span><br><span class="line">            <span class="string">&quot;Scan %s Complete In %d Hours %d Minutes %d Seconds. Found %u Open Ports\r\n&quot;</span>,</span><br><span class="line">            startIpAddr,</span><br><span class="line">            hoursElapsed,</span><br><span class="line">            minutesElapsed,</span><br><span class="line">            secondsElapsed,</span><br><span class="line">            _totalPortsOpen);</span><br><span class="line">          logWriteBuffer(_logFile, buf);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(</span><br><span class="line">          <span class="string">&quot;Scan %u IPs Complete In %d Hours %d Minutes %d Seconds. Found %u Hosts\r\n&quot;</span>,</span><br><span class="line">          _endIp - _startIp + <span class="number">1</span>,</span><br><span class="line">          hoursElapsed,</span><br><span class="line">          minutesElapsed,</span><br><span class="line">          secondsElapsed,</span><br><span class="line">          _totalPortsOpen);</span><br><span class="line">        <span class="keyword">if</span> ( _isLog )</span><br><span class="line">        &#123;</span><br><span class="line">          wsprintf(</span><br><span class="line">            buf,</span><br><span class="line">            <span class="string">&quot;Scan %u IPs Complete In %d Hours %d Minutes %d Seconds. Found %u Hosts\r\n&quot;</span>,</span><br><span class="line">            _endIp - _startIp + <span class="number">1</span>,</span><br><span class="line">            hoursElapsed,</span><br><span class="line">            minutesElapsed,</span><br><span class="line">            secondsElapsed,</span><br><span class="line">            _totalPortsOpen);</span><br><span class="line">          logWriteBuffer(_logFile, buf);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( _isLog )</span><br><span class="line">      logWriteBuffer(_logFile, <span class="string">&quot;-------------------------------------------------------------------------------\r\n\r\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">__faild:</span><br><span class="line">  <span class="keyword">if</span> ( _semaphore )</span><br><span class="line">	  CloseHandle(_semaphore);</span><br><span class="line">  <span class="keyword">if</span> ( _s != <span class="number">-1</span> )</span><br><span class="line">	  closesocket(_s);</span><br><span class="line">  <span class="keyword">if</span> ( _portsArray )</span><br><span class="line">	  <span class="built_in">free</span>(_portsArray);</span><br><span class="line">  WSACleanup();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span>	ret;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;TCP Port Scanner V1.2 By WinEggDrop\n\n&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> ( argc == <span class="number">4</span> || argc == <span class="number">5</span> || argc == <span class="number">6</span> || argc == <span class="number">7</span> || argc == <span class="number">8</span> || argc == <span class="number">9</span> )</span><br><span class="line">	&#123;</span><br><span class="line">	 <span class="keyword">if</span> ( SetConsoleCtrlHandler(ConsoleCtrlHandler, TRUE) )</span><br><span class="line">	 &#123;</span><br><span class="line">		 <span class="keyword">if</span> ( InitializeCriticalSectionAndSpinCount(&amp;_cs, <span class="number">0x80000400</span>) )</span><br><span class="line">		 &#123;</span><br><span class="line">			 <span class="keyword">int</span> arg = argc;</span><br><span class="line">			 <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">3</span>; i++)</span><br><span class="line">			 &#123;</span><br><span class="line">				<span class="keyword">if</span> (!lstrcmpi(argv[argc - i], <span class="string">&quot;/Save&quot;</span>))</span><br><span class="line">				&#123;</span><br><span class="line">					_isLog = TRUE;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span> <span class="keyword">if</span> (!lstrcmpi(argv[argc - i], <span class="string">&quot;/Banner&quot;</span>))</span><br><span class="line">				&#123;</span><br><span class="line">					_isBanner = TRUE;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span> <span class="keyword">if</span> (!lstrcmpi(argv[argc - i], <span class="string">&quot;/HBanner&quot;</span>))</span><br><span class="line">				&#123;</span><br><span class="line">					_isBanner = TRUE;</span><br><span class="line">					_isHttp = TRUE;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span> <span class="keyword">if</span> (!_strnicmp(argv[argc - i], <span class="string">&quot;/T&quot;</span>, <span class="number">2</span>))</span><br><span class="line">				&#123;</span><br><span class="line">					_tcpTimeout = atoi(argv[argc - i]+<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">					<span class="keyword">if</span> (!_tcpTimeout)</span><br><span class="line">					&#123;</span><br><span class="line">						<span class="built_in">printf</span>(<span class="string">&quot;Invalid timeout value\n&quot;</span>);</span><br><span class="line">						<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">continue</span>;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				arg--;</span><br><span class="line">			 &#125;</span><br><span class="line">			 </span><br><span class="line">			 <span class="keyword">switch</span> ( arg )</span><br><span class="line">			 &#123;</span><br><span class="line">			 <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">				 startScan(argv[<span class="number">1</span>], argv[<span class="number">2</span>], <span class="number">0</span>, argv[<span class="number">3</span>], <span class="string">&quot;1&quot;</span>);</span><br><span class="line">				 <span class="keyword">break</span>;</span><br><span class="line">			 <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">				 <span class="keyword">if</span> ( lstrcmpi(argv[<span class="number">1</span>], <span class="string">&quot;SYN&quot;</span>) )</span><br><span class="line">					 startScan(argv[<span class="number">1</span>], argv[<span class="number">2</span>], <span class="number">0</span>, argv[<span class="number">3</span>], argv[<span class="number">4</span>]);</span><br><span class="line">				 <span class="keyword">else</span></span><br><span class="line">					 startScan(argv[<span class="number">1</span>], argv[<span class="number">2</span>], argv[<span class="number">3</span>], argv[<span class="number">4</span>], <span class="string">&quot;1&quot;</span>);</span><br><span class="line">				 <span class="keyword">break</span>;</span><br><span class="line">			 <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">				 startScan(argv[<span class="number">1</span>], argv[<span class="number">2</span>], argv[<span class="number">3</span>], argv[<span class="number">4</span>], argv[<span class="number">5</span>]);</span><br><span class="line">				 <span class="keyword">break</span>;</span><br><span class="line">			 &#125;</span><br><span class="line">			 DeleteCriticalSection(&amp;_cs);</span><br><span class="line">			 ret = <span class="number">0</span>;</span><br><span class="line">		 &#125;</span><br><span class="line">		 <span class="keyword">else</span></span><br><span class="line">		 &#123;</span><br><span class="line">			 ret = <span class="number">-1</span>;</span><br><span class="line">		 &#125;</span><br><span class="line">	 &#125;</span><br><span class="line">	 <span class="keyword">else</span></span><br><span class="line">	 &#123;</span><br><span class="line">		 <span class="built_in">printf</span>(<span class="string">&quot;Could Not Set Up Control Handler\n&quot;</span>);</span><br><span class="line">		 ret = <span class="number">-1</span>;</span><br><span class="line">	 &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line"> &#123;</span><br><span class="line">	 help(argv[<span class="number">0</span>]);</span><br><span class="line">	 ret = <span class="number">-1</span>;</span><br><span class="line"> &#125;</span><br><span class="line">  <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2020-10-07</span><i class="fa fa-tag"></i><a class="tag" href="/tags/c/" title="c">c </a><span class="leancloud_visitors"></span></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="" onclick="javascript:join_favorite()" ref="sidebar"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,http://example.com/2020/10/07/S扫描器源码/,Hexo,S扫描器源码,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2020/10/07/Field-%E2%80%98id%E2%80%99-doesn%E2%80%99t-have-a-default-value%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/" title="Field ‘id’ doesn’t have a default value问题解决方法">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2020/10/07/THE-SUCCESS-INDICATOR/" title="THE SUCCESS INDICATOR">下一篇</a></li></ul></div><script src="/js/visitors.js"></script><a id="comments"></a><div id="vcomments" style="margin:0 30px;"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/gh/xcss/valine@latest/dist/Valine.min.js"></script><script>var valine = new Valine({
  el:'#vcomments',
  notify:false || false, 
  verify:false|| false, 
  app_id:'',
  app_key:'',
  placeholder:'念念不忘，必有回响...',
  path: window.location.pathname,
  serverURLs: '',
  visitor:true,
  recordIP:true,
  avatar:'mp'
})</script></div></div></div></div><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/add-bookmark.js"></script><script src="/js/baidu-tongji.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"left","width":200,"height":400,"hOffset":5,"vOffset":-38},"mobile":{"show":false,"scale":0.2},"react":{"opacityDefault":0.8,"opacityOnHover":0.2},"log":false});</script></body></html>